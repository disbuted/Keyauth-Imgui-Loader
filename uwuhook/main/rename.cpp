//⠄⠄⠄⠄⠄⠄⠄⠄⢀⣀⣀⣶⣿⢟⣵⣿⣿⣿⣿⣿⢿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣙⣷⣶⣶⣤⣄⣀⣀⠄⠄⠄⠄⠄⠄
//⠄⠄⠄⢀⣤⣶⣶⣿⣿⠿⠿⠛⢫⣿⣿⣿⣿⣿⡟⣱⣿⣿⢿⣿⣿⣿⣿⣿⣿⡇⣿⣿⣿⣿⣿⣿⣿⣿⣷⠻⣿⣿⣿⣿⣿⣿⣿⠈⠉⠉⠙⠛⠻⢿⣿⣶⣶⣤⡀⠄
//⢠⣼⣿⡿⠛⠛⠁⠄⠄⠄⠄⣴⣿⣿⣿⣿⣿⣏⣼⣿⣿⢣⣿⣿⣿⣿⣿⣿⣿⣷⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡙⢿⣿⣿⣿⣿⣿⠄⠄⠄⠄⠄⠄⠄⠄⠄⠙⠛⠻⣿
//⣿⣟⠁⠄⠄⠄⠄⠄⠄⢀⣼⣿⣿⣿⣿⣿⢧⣾⣿⣿⡟⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡞⢿⣿⣿⣿⣿⣧⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⢠
//⢸⣿⡄⠄⠄⠄⠄⠄⢀⣼⣿⣿⣿⣿⣿⢧⣾⢻⣿⣿⢁⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡞⢿⣿⣿⣿⣿⡄⠄⠄⠄⠄⠄⠄⠄⠄⠄⢀⣼
//⠘⣿⣷⠄⠄⠄⠄⠄⣼⣿⣿⣿⣿⣿⢏⣼⣇⣿⣿⣿⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡼⣿⣿⣿⣿⣿⡀⠄⠄⠄⠄⠄⠄⠄⢀⣼⡏
//⠄⢸⣿⣆⠄⠄⠄⣸⣿⣿⣿⣿⣿⡿⣼⣿⢹⣿⣿⣿⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣾⣿⣿⣿⡿⣿⣿⣿⣿⣿⣿⣷⢹⣿⣿⣿⣿⣷⡄⠄⠄⠄⠄⠄⢀⣾⡟⠄
//⠄⠄⠹⣿⣄⠄⣰⣿⣏⣿⣿⣿⣿⠁⣿⣿⢸⣿⣿⣿⠄⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⢿⣿⣿⣷⠹⣿⣿⣿⣿⣿⣿⡉⣿⣿⣿⣿⣿⣷⣆⠄⠄⠄⣀⣾⠋⠄⠄
//⠄⠄⠄⣿⣿⢄⣿⣿⢿⣿⣿⣿⡿⢸⣿⡿⢸⣿⣿⣿⢚⠹⣿⢿⣿⣿⣿⢻⣿⣿⣿⣿⡇⠸⣿⣿⣿⡄⠙⣿⣿⣹⣿⣿⡇⢸⣿⣿⣿⣿⡿⣿⡆⡀⠄⣿⡏⠄⠄⠄
//⠄⠄⣠⣿⡟⣼⣿⣿⢸⣿⣿⣿⠇⢸⡿⣳⣧⣻⣿⣿⢻⣷⣝⢦⢻⣿⣿⡞⠻⣿⣿⣿⣿⣴⣜⢿⣿⣧⢿⣮⡻⠏⣿⣿⢷⡆⣿⣿⣿⣿⡇⣿⣿⡜⣿⡹⣧⠄⠄⠄
//⠄⢸⣿⡿⢠⣿⣿⣿⢸⣿⣿⣿⠄⢘⣾⣿⣿⣷⣜⡛⠘⣿⣿⣷⣦⣜⢻⣿⣦⢬⡛⢿⣿⣧⢻⣷⣬⣛⠦⢿⣿⡇⣿⢯⡼⣧⣿⣿⣿⣿⡇⣿⣿⣿⢻⣷⢿⡄⠄⠄           ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⢠⣿⣿⡁⣾⣿⣿⣿⢸⣿⣿⣿⣤⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣬⣵⣽⣿⣶⣬⣥⣿⣿⣿⣿⣿⣿⣇⣷⣿⣿⣦⣿⣿⣿⣿⢿⣿⣿⣿⣆⣿⡌⣿⡄⠄           ⣿  uwuhook dev release    ⣿
//⣼⣿⢇⢃⣿⣿⣿⣿⡿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣸⣿⣿⣿⣿⢹⣿⢻⣇⠄           ⣿    all made by me       ⣿
//⣿⣏⣾⣸⣿⣿⣿⣿⡇⢿⣿⡿⣿⣿⣿⠿⠿⠿⠿⠿⠿⠷⢶⣭⣽⣿⣿⣿⣿⣿⣿⣿⣿⣯⡵⢾⠛⠛⠉⠉⠉⠛⣛⡿⢿⣿⣿⣿⣿⢡⣿⣿⣿⣿⣿⡆⣿⣆⢿⡆           ⣿   if you got this src   ⣿
//⡿⢹⡏⣿⣿⣿⣿⣿⣿⡼⣿⡇⠿⢋⣒⣚⣃⣀⣀⣀⣀⣀⣀⣈⣉⣹⣿⣿⣿⣿⣿⣿⣯⣡⣤⣭⣤⣤⣴⣦⣤⣤⣭⣭⣅⣈⣿⣿⡟⣾⣿⣿⣿⣿⠏⣿⢳⠻⣾⣧           ⣿   it either got leaked  ⣿
//⣇⣿⠁⣿⢿⣿⣿⣿⣿⣧⢹⣷⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⣿⣴⣿⣿⣿⣿⡟⣾⣿⡈⣷⡁⣿           ⣿   it i selfleaked it    ⣿
//⢻⣿⢸⣿⡌⣿⣿⣿⣿⣿⣧⢿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠇⣿⢋⣿⣿⣿⣿⢯⣼⣿⣿⣇⣿⣧⢻           ⣿ ----------------------  ⣿
//⢸⡇⢸⣿⣿⠹⣿⣿⣿⣿⣿⣦⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⣼⠟⣾⣿⣿⡿⢣⣾⣿⣿⣿⣿⣿⣿⣏           ⣿  https://e-z.bio/%C2%A3 ⣿
//⣿⡇⢸⣿⣿⣷⡙⢿⣿⣿⣿⣿⣦⢻⣿⣿⣿⣿⣿⣿⣿⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⢻⣿⣿⣿⣿⣿⣿⣿⢳⢛⣾⣿⣿⢛⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿           ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⡇⠘⣿⣿⣿⣿⣏⡻⣿⣿⣿⣿⣧⠻⣿⣿⣿⣿⣿⣿⣿⣤⣲⠶⢶⣶⣶⣶⣶⣶⣶⡶⢿⣫⣼⣿⣿⣿⣿⣿⣿⣿⠇⣳⣿⣿⢟⣴⣿⣿⣿⣿⣿⣿⣿⣿⣿⣻⣿
//⣿⣿⠄⠻⣿⣿⣿⣿⣷⣎⣛⢿⣿⣿⣷⡽⢿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣶⣶⣶⣶⣶⣶⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⢏⣰⡿⣋⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⠏⣿⡏⢿
//⢹⣿⠄⠄⠻⣿⣿⣿⣿⣿⣿⣶⣍⣻⢿⣿⣎⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠿⢋⢞⣫⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠋⢀⣿⡷⠘
//⣸⡏⠄⠄⠄⠙⣿⣿⣿⣿⣿⣿⣿⣿⣶⣮⣍⡣⠄⠉⠉⠙⠛⠿⠿⣿⣿⣿⣿⣿⣿⣿⡿⠿⠟⠋⠉⠉⠁⠄⠄⣰⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠁⠄⣾⣿⡇⠄
//⡟⣿⠄⠄⠄⠄⠈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣤⠄⠄⠄⠄⡀⣤⣤⣀⣀⡀⠄⣀⣀⣠⣤⣴⣿⠃⣦⠄⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠃⠄⠄⣴⣿⣿⠃⠄
//⣿⡜⡆⠄⠘⣄⠄⠄⠄⠙⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⠄⠄⣼⣦⡝⢿⣿⣿⣿⣿⣿⣿⡿⢟⣣⣶⣿⣿⣼⣿⣿⣿⣿⣿⣿⣿⡿⠟⠛⠁⠄⠄⠄⣴⣿⣿⢣⡆⠄
//⢻⣿⣦⡀⠄⣿⣧⡄⠄⠄⠄⠄⠉⠛⠻⠿⣿⣿⣿⣿⣿⣷⠺⣿⣿⣿⣷⣜⡛⣿⡿⢛⣥⣾⣿⣿⣿⣿⡇⣿⣿⣿⠟⠛⠋⠄⠄⠄⠄⠄⠄⢀⣰⣿⣿⣿⣫⣿⣧⣴
//⠄⠘⠿⣿⣶⣼⣿⢿⣷⣄⣀⠄⠄⠄⠄⠄⠄⠄⠈⠉⠛⠿⣧⣿⣿⣿⣿⡿⢿⣠⣘⡿⢿⣿⣿⣿⣿⠿⡇⡿⠋⠄⠄⠄⠄⣀⣀⣀⣤⣴⣾⣿⡿⠿⣋⣾⠿⠛⠛⠋
//⠄⠄⠄⠈⠉⠉⠄⠄⠉⠻⠿⣷⣶⣤⣀⣀⣀⣀⣀⣀⣀⣀⡈⢸⣯⣽⣷⡾⠿⠟⠿⢿⣷⣶⣶⣶⣶⣿⡇⣀⣀⣀⣐⣚⣛⣿⣿⣿⣛⣛⣩⣽⣶⠿⠟⠉⠄⠄⠄⠄

#include "../headers/rename.h"
#include <windows.h>
#include <filesystem>
#include <random>

namespace fs = std::filesystem;

bool LegitRename::Rename() {
    // current path 
    char currentPath[MAX_PATH];
    if (!GetModuleFileNameA(nullptr, currentPath, MAX_PATH)) return false;

    // list of random windows processes 
    const char* names[] = {
      "notepad.exe",
      "calc.exe",
      "mspaint.exe",
      "wordpad.exe",
      "charmap.exe",
      "cleanmgr.exe",
      "clipbrd.exe",
      "cmd.exe",
      "control.exe",
      "dxdiag.exe",
      "eventvwr.exe",
      "explorer.exe",
      "fsquirt.exe",
      "iexplore.exe",
      "magnify.exe",
      "msconfig.exe",
      "mshearts.exe",
      "mspaint.exe",
      "mstsc.exe",
      "osk.exe",
      "perfmon.exe",
      "powershell.exe",
      "regedit.exe",
      "sndrec32.exe",
      "sndvol32.exe",
      "sol.exe",
      "taskmgr.exe",
      "winhlp32.exe",
      "winver.exe",
      "write.exe",
      "wscript.exe",
      "cscript.exe",
      "svchost.exe",
      "dwm.exe",
      "csrss.exe",
      "wininit.exe",
      "services.exe",
      "lsass.exe",
      "smss.exe",
      "winlogon.exe",
      "spoolsv.exe",
      "taskhostw.exe",
      "RuntimeBroker.exe",
      "dllhost.exe",
      "svchost.exe",
      "backgroundTaskHost.exe",
      "armsvc.exe",
      "atiesrxx.exe",
      "audiodg.exe",
      "bfsvc.exe",
      "conhost.exe",
      "dasHost.exe",
      "dllhst3g.exe",
      "fontdrvhost.exe",
      "hkcmd.exe",
      "igfxpers.exe",
      "jusched.exe",
      "mmc.exe",
      "msdtc.exe",
      "msiexec.exe",
      "mobsync.exe",
      "ngentask.exe",
      "pcalua.exe",
      "poqexec.exe",
      "PresentationFontCache.exe",
      "SearchIndexer.exe",
      "SearchProtocolHost.exe",
      "sihost.exe",
      "smartscreen.exe",
      "sppsvc.exe",
      "TiWorker.exe",
      "unsecapp.exe",
      "vssvc.exe",
      "wbengine.exe",
      "WmiPrvSE.exe"
    };

    std::random_device rd;
    std::uniform_int_distribution<size_t> dist(0, sizeof(names) / sizeof(names[0]) - 1);
    std::string newName = names[dist(rd)];

    fs::path oldPath(currentPath);
    fs::path newPath = oldPath.parent_path() / newName;

    try {
        fs::rename(oldPath, newPath);
        return true;
    }
    catch (...) {
        return false;
    }
}


